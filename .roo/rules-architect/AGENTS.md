# AGENTS.md - Architect Mode

This file provides guidance to agents when working with code in this repository.

## 系统架构设计

### 整体架构模式

- **客户端优先架构**：评价过程完全在客户端完成，服务器仅用于最终数据存储
- **离线优先设计**：所有核心功能支持离线操作，网络连接仅用于数据同步
- **微服务 API 设计**：评价、人员、用户评价数据分离为独立 API 端点

### 数据流架构

```
用户身份验证 → 本地数据缓存 → 评价操作 → 本地存储 → 批量提交 → 服务器存储
```

### 核心设计决策

#### 本地存储策略

- **设计理念**：保护用户隐私，提供离线能力，减少服务器负载
- **数据结构**：按用户 ID 分组的嵌套对象结构，支持多部门评价
- **同步机制**：批量提交模式，确保数据一致性

#### 等级分布验证

- **业务规则硬编码**：各部门等级分布要求直接写在验证逻辑中
- **实时验证**：评价过程中实时显示分布状态和调整建议
- **强制约束**：分布不满足要求时禁止提交，确保业务规则执行

#### 用户身份管理

- **无密码认证**：基于姓名和身份证号的本地验证
- **加密用户 ID**：使用简单哈希算法生成唯一标识
- **角色权限**：三种用户角色对应不同的评价权限和流程

### 扩展性考虑

#### 部门扩展

- **硬编码人员数据**：当前人员数据直接写在代码中，扩展需要修改源码
- **部门配置化**：等级分布规则硬编码，可考虑提取为配置文件
- **角色系统**：当前三种角色固定，可设计为更灵活的权限系统

#### 评价标准扩展

- **维度配置**：当前 10 个评价维度固定，可考虑动态配置
- **权重系统**：各维度权重相等，可引入差异化权重
- **自定义标准**：不同部门可使用不同的评价标准

### 性能优化策略

#### 客户端优化

- **数据缓存**：人员数据和评价标准在组件初始化时加载
- **计算优化**：使用 useMemo 缓存等级统计和验证结果
- **懒加载**：大型部门可考虑分页加载人员列表

#### 存储优化

- **localStorage 限制**：监控存储使用，避免超出浏览器限制
- **数据压缩**：考虑对大量评价数据进行压缩存储
- **定期清理**：提交成功后及时清理本地数据

### 安全架构

#### 隐私保护

- **本地处理**：敏感信息（身份证号）仅用于本地验证，不上传
- **数据加密**：用户 ID 使用哈希算法，避免明文存储
- **访问控制**：基于角色的评价权限控制

#### 数据完整性

- **验证机制**：多层数据验证确保提交数据正确性
- **事务处理**：批量提交使用事务确保数据一致性
- **错误恢复**：网络失败时保留本地数据，支持重试

### 技术债务与改进方向

#### 架构改进

- **状态管理**：考虑引入 Redux 或 Zustand 管理复杂状态
- **类型安全**：迁移到 TypeScript 提高代码质量
- **测试覆盖**：增加单元测试和集成测试

#### 业务流程优化

- **实时协作**：考虑多用户实时评价状态同步
- **审批流程**：增加评价结果审批环节
- **报表系统**：完善评价结果统计和报表功能
