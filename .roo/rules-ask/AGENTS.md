# AGENTS.md - Ask Mode

This file provides guidance to agents when working with code in this repository.

## 项目文档指南

### 核心业务概念

- **人员评价系统**：国贸集团青云通公司的员工绩效考核平台
- **三部门结构**：经控贸易（55 人）、开投贸易（23 人）、职能部门（5 人，无等级分布要求）
- **评价流程**：本地存储 → 批量提交 → 等级分布验证

### 关键数据流

1. **身份验证**：姓名+身份证号 → 生成加密用户 ID → 存储到 localStorage
2. **评价过程**：选择人员 → 多维度评分 → 保存到本地存储
3. **提交阶段**：验证等级分布 → 批量提交到服务器 → 清空本地数据

### 评价标准体系

- **10 个维度**：责任心、勤勉性、爱岗敬业、合作性、专业知识、判断能力、学习能力、工作成效、工作质量、工作效率
- **等级划分**：A(优秀 ≥95 分)、B(良好 85-94 分)、C(合格 75-84 分)、D(基本合格 65-74 分)、E(不合格<65 分)
- **分布限制**：经控贸易和开投贸易部门有严格的等级人数限制，职能部门无分布要求

### 技术架构要点

- **Next.js 16**：现代 React 框架，支持服务端渲染和客户端组件
- **本地存储优先**：评价数据完全存储在浏览器 localStorage 中，支持离线操作
- **Supabase 后端**：提供数据库和 API 服务，用于最终数据存储
- **shadcn/ui 组件**：使用现代 UI 组件库，提供一致的用户体验

### 用户角色权限

- **leader（负责人）**：部门负责人，有特定的评价权重
- **employee（员工）**：普通员工，参与部门内评价
- **functional（职能部门）**：跨部门评价，需要评价多个业务部门

### 重要业务规则

- **等级分布强制验证**：经控贸易和开投贸易部门必须满足分布要求才能提交，职能部门无此限制
- **评价权重计算**：最终成绩 = 负责人评价 ×70% + 其他员工评价 ×30%
- **数据隔离**：每个用户的评价数据独立存储，互不干扰
- **隐私保护**：身份证号仅用于身份验证，不上传到服务器

### 常见问题解答

- **为什么使用本地存储**：确保评价过程的隐私性和离线可用性
- **如何处理评价冲突**：相同人员多次评价以最新提交为准
- **职能部门特殊流程**：需要逐个部门完成评价，使用 completedDepartments 跟踪进度
- **等级分布不满足怎么办**：系统提供调整建议，需要修改部分评价等级
