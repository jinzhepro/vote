# 项目架构规则 (非显而易见)

## 系统架构设计

- 前端采用 Next.js App Router 架构，支持服务端渲染
- 数据层支持双数据库：Supabase（云端）+ PostgreSQL（本地）
- 状态管理依赖 localStorage，确保离线可用性

## 数据流架构

- 评价数据流：本地存储 → 批量验证 → 服务器提交
- 用户认证流：姓名身份证验证 → 加密 ID 生成 → 会话保持
- 部门权限流：角色识别 → 部门筛选 → 评价范围控制

## 组件架构层次

- 页面层：`src/app/`下的路由页面
- 组件层：`src/components/`下的可复用组件
- 数据层：`src/data/`和`src/lib/`下的数据和工具函数

## 关键设计决策

- 本地优先策略：确保在网络不稳定时仍可完成评价
- 静态人员数据：避免频繁数据库查询，提高性能
- 等级分布验证：业务规则硬编码，确保数据一致性

## 扩展性考虑

- 部门配置化：当前部门硬编码，可考虑配置化管理
- 评分标准可配置：当前固定 10 个维度，可考虑动态配置
- 多租户支持：当前单公司使用，架构支持多公司扩展

## 安全架构

- 用户 ID 加密：基于姓名和部门生成，避免敏感信息泄露
- 数据传输加密：通过 HTTPS 和 Supabase 安全策略
- 本地数据保护：localStorage 数据仅存储必要信息
