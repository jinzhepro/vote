# 人员管理模块使用说明

## 概述

人员管理模块已集成到现有的投票系统中，提供完整的贸易部门人员信息管理功能。

## 功能特性

- ✅ 人员信息的增删改查
- ✅ 按部门分类管理（经控贸易、开投贸易）
- ✅ 人员搜索和筛选功能
- ✅ 部门统计信息展示
- ✅ 响应式设计，支持移动端
- ✅ 使用 Neon 数据库存储数据

## 数据库配置

### 1. 环境变量设置

在 `.env.local` 文件中配置 Neon 数据库连接：

```env
DATABASE_URL="postgresql://username:password@hostname/database?sslmode=require"
```

### 2. 获取 Neon 数据库 URL

1. 登录 [Neon Console](https://console.neon.tech/)
2. 创建新项目或选择现有项目
3. 在项目设置中找到连接字符串
4. 复制连接字符串到 `.env.local` 文件

## 初始化步骤

### 1. 启动应用

```bash
npm run dev
```

### 2. 初始化数据库

访问 `http://localhost:3000/init` 页面：

1. 点击"初始化数据库"按钮
2. 系统将自动创建数据库表
3. 录入预置的人员数据（67 名人员）

### 3. 验证初始化

初始化成功后，页面将显示：

- ✅ 数据库已初始化
- ✅ 67 名人员已录入
- ✅ 2 个部门已创建

## 使用指南

### 访问人员管理

1. 在首页点击"人员管理"按钮
2. 或直接访问 `http://localhost:3000/staff`

### 主要功能

#### 1. 查看人员列表

- 按部门分组显示所有人员
- 显示人员姓名、职位、联系方式
- 实时统计各部门人数

#### 2. 搜索和筛选

- 按姓名、职位、邮箱搜索人员
- 按部门筛选人员
- 支持模糊搜索

#### 3. 添加人员

- 点击"添加人员"按钮
- 填写人员基本信息
- 选择所属部门
- 保存后自动返回列表

#### 4. 编辑人员

- 在人员卡片上点击"编辑"按钮
- 修改人员信息
- 保存更新

#### 5. 删除人员

- 在人员卡片上点击"删除"按钮
- 确认删除操作

## 数据结构

### 部门表 (departments)

- `id`: 主键
- `name`: 部门名称
- `description`: 部门描述
- `created_at`: 创建时间

### 人员表 (employees)

- `id`: 主键
- `name`: 姓名
- `department_id`: 部门 ID（外键）
- `position`: 职位
- `email`: 邮箱
- `phone`: 电话
- `created_at`: 创建时间
- `updated_at`: 更新时间

## 预置数据

### 经控贸易部门（46 人）

郑效明、赵晓、薛慧、张倩、敬志伟、薛清华、邵汉明、陈立群、
赵安琪、刘婷、方舟、韩晓青、赵邦宇、刘丽、李鸿康、张津诚、
马丽萍、李昕益、王泽民、张梦卿、张新军、赵惠东、张笑艳、韩高洁、
孙琨、刘萍、薛洋、潘振龙、侯继儒、沙绿洲、庞东、张鹏京、
闫书奇、吕仕杰、孔帅、王伊凡、杨春梅、管伟胜、刘雅超、付冰清、
张晋哲、原豪豪、崔建刚、张照月、廖斌、杨颖

### 开投贸易部门（21 人）

周晓彬、陆剑飞、薛德晓、张龙龙、唐国彬、杨仕玉、刘娜、王珉、
初凯、段启愚、高青、纪蕾、王杰、杨龙泉、迟浩元、刘伟玉、
陈雨田、高洋、毛璐杰、杜嘉祎、臧梦娇

## API 接口

### 人员管理 API

- `GET /api/staff` - 获取所有人员和部门
- `POST /api/staff` - 创建新人员
- `GET /api/staff/[id]` - 获取单个人员信息
- `PUT /api/staff/[id]` - 更新人员信息
- `DELETE /api/staff/[id]` - 删除人员

### 部门管理 API

- `GET /api/staff/departments` - 获取所有部门

### 初始化 API

- `GET /api/init` - 检查初始化状态
- `POST /api/init` - 初始化数据库和数据

## 故障排除

### 常见问题

1. **数据库连接失败**

   - 检查 `.env.local` 文件中的 `DATABASE_URL` 是否正确
   - 确认 Neon 数据库服务正常运行

2. **初始化失败**

   - 检查数据库权限
   - 确认网络连接正常
   - 查看控制台错误信息

3. **页面加载缓慢**
   - 检查网络连接
   - 确认数据库响应时间

### 调试方法

1. 打开浏览器开发者工具
2. 查看 Console 面板的错误信息
3. 检查 Network 面板的 API 请求状态

## 技术栈

- **前端**: Next.js 16.0.7, React 19.2.0, Tailwind CSS
- **后端**: Next.js API Routes
- **数据库**: Neon PostgreSQL
- **数据库客户端**: @neondatabase/serverless

## 扩展功能建议

1. **权限管理**: 添加用户登录和权限控制
2. **批量操作**: 支持批量导入/导出人员数据
3. **高级搜索**: 添加更多搜索条件
4. **数据统计**: 生成人员统计报表
5. **部门管理**: 支持动态添加/编辑部门
